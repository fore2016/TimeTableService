package com.yg.timetableservice.rxjava;

import com.alibaba.fastjson.JSONObject;
import com.yg.timetableservice.struct.ReturnResult;
import org.springframework.web.context.request.async.DeferredResult;
import rx.Subscriber;


public class ReturnResultSubscriber extends Subscriber<String> {
    private DeferredResult<String> deferredResult;
    @Override
    public void onCompleted() {
    }

    @Override
    public void onError(Throwable throwable) {
        ReturnResult errorResult = ReturnResult.getErrorResult(throwable.toString());
        deferredResult.setResult("**YGKJ" + JSONObject.toJSONString(errorResult) + "YGKJ##");
    }

    @Override
    public void onNext(String res) {
        if (res != null)
            deferredResult.setResult(res);
        else
            deferredResult.setResult("**YGKJ" + JSONObject.toJSONString(ReturnResult.getNullResult()) + "YGKJ##");
    }
    public ReturnResultSubscriber(DeferredResult<String> deferredResult) {
        this.deferredResult = deferredResult;
    }

}
