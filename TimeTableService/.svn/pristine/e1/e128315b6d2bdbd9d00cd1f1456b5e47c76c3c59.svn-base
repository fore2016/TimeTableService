package com.yg.timetableservice.rxjava;

import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.yg.timetableservice.struct.ReturnResult;
import org.springframework.web.context.request.async.DeferredResult;
import rx.Subscriber;


public class ReturnResultSubscriber extends Subscriber<ReturnResult> {
    private DeferredResult<String> deferredResult;
    @Override
    public void onCompleted() {
    }

    @Override
    public void onError(Throwable throwable) {
        ReturnResult errorResult = ReturnResult.getErrorResult(throwable.toString());
        deferredResult.setResult(JSONObject.toJSONString(errorResult));
    }

    @Override
    public void onNext(ReturnResult res) {
        deferredResult.setResult(JSONObject.toJSONString(res));
    }
    public ReturnResultSubscriber(DeferredResult<String> deferredResult) {
        this.deferredResult = deferredResult;
    }

}
